# üìö CLAUDE TRVAL√Å PAMƒö≈§ - PAPERLESS NGX PROJEKT

## ‚ö†Ô∏è D≈ÆLE≈ΩIT√â: T≈òI PAPERLESS PROCESY
**Paperless A:** http://localhost:8060 (hlavn√≠ produkce)  
**Paperless B:** http://localhost:8050 (testovac√≠ - MBW dokumenty)  
**Paperless C:** http://localhost:8075 (nov√° instance - HTML GUI testy s Ultimate Detector V10)  
**MCP SERVER:** http://localhost:5002
**LiteLLM Proxy:** http://localhost:4000 (OpenAI-compatible API, plnƒõ funkƒçn√≠)

### üìÑ KOMPLETN√ç DOKUMENTACE PROCES≈Æ:
- **[PAPERLESS_DUAL_PROCESS_DOCUMENTATION.md](./PAPERLESS_DUAL_PROCESS_DOCUMENTATION.md)** - P≈ôehled proces≈Ø A & B
- **[PAPERLESS_MCP_V4_COMPLETE_DOCUMENTATION.md](./PAPERLESS_MCP_V4_COMPLETE_DOCUMENTATION.md)** - Proces A (8060) detaily
- **[MBW-Paperless-8050-backup/SYSTEM_COMPLETE_DOCUMENTATION.md](./MBW-Paperless-8050-backup-20250901-223950/SYSTEM_COMPLETE_DOCUMENTATION.md)** - Proces B (8050) detaily
- **Proces C (8075):** Urƒçen pro HTML GUI testov√°n√≠ s integrovan√Ωm Ultimate Document Detector V10 (94% p≈ôesnost)

---

# üÜï AKTUALIZACE 2025-09-05: KOMPLETN√ç MCP V4 INTEGRACE!

## üì¶ Paperless NGX Fixes v0.1 - Kompletn√≠ opravy a automatick√© tagov√°n√≠
**Verze:** 0.1  
**Datum vyd√°n√≠:** 3.9.2025 23:55  
**Um√≠stƒõn√≠:** `/Users/m.a.j.puzik/paperless-ngx-fixes-v0.1/`  
**Backup:** Google Drive/Paperless Fixes/paperless-ngx-fixes-v0.1.zip  
**Dokumentace:** `/Users/m.a.j.puzik/PAPERLESS_NGX_FIX_DOCUMENTATION_v0.1.md`

### ‚úÖ Co je opraveno:
- Upload soubor≈Ø se speci√°ln√≠mi znaky (mezery, z√°vorky, ƒçesk√© znaky)
- Ghost dokumenty v datab√°zi (#210)
- Chybn√° detekce duplik√°t≈Ø u ƒåSOB v√Ωpis≈Ø
- Automatick√© tagov√°n√≠ v≈°ech dokument≈Ø
- 100% pokryt√≠ metadaty (189 dokument≈Ø)

### üöÄ Instalace (3 kroky):
```bash
# 1. Zkop√≠rovat post-processor
docker cp /Users/m.a.j.puzik/paperless-ngx-fixes-v0.1/intelligent_post_processor.py \
  paperless-ngx:/usr/src/paperless/scripts/post_process.py

# 2. Nastavit spustitelnost
docker exec paperless-ngx chmod +x /usr/src/paperless/scripts/post_process.py

# 3. Restartovat
docker restart paperless-ngx
```

### üìä Statistiky v0.1:
- 189 dokument≈Ø zpracov√°no
- 20 tag≈Ø vytvo≈ôeno
- 14 korespondent≈Ø p≈ôi≈ôazeno
- 0 dokument≈Ø bez metadat
- 100% √∫spƒõ≈°nost tagov√°n√≠

---

# üñ•Ô∏è AKTUALIZACE 2025-09-03: AI MONITOR UNIFIED v0.1

## üìä AI Monitor Unified - Centralizovan√Ω monitoring syst√©m
**Port:** 8900  
**Um√≠stƒõn√≠:** `/Users/m.a.j.puzik/zahnpasta/ai_monitor_unified.py`  
**Dokumentace:** `/Users/m.a.j.puzik/AI_MONITOR_UNIFIED_DOCUMENTATION.md`  
**Z√°loha:** Google Drive/AI Monitor Backups/AI-Monitor-Unified-v0.1-20250903.zip

### Spu≈°tƒõn√≠:
```bash
cd /Users/m.a.j.puzik/zahnpasta
python3 ai_monitor_unified.py
```

### Moduly (v≈°e p≈ôes port 8900):
- **System Monitor:** http://localhost:8900/module/system
- **LLM Monitor:** http://localhost:8900/module/llm  
- **Docker Monitor:** http://localhost:8900/module/docker
- **Process Monitor:** http://localhost:8900/module/processes
- **Network Scanner:** http://localhost:8900/module/network

### API Endpoints:
- `/api/system`, `/api/llm`, `/api/docker`, `/api/processes`, `/api/network`

**Koncept:** V≈°echny monitorovac√≠ moduly bƒõ≈æ√≠ jako pod-GUI v hlavn√≠m GUI na jedin√©m portu.

---

# üÜï AKTUALIZACE 2025-09-03: OPRAVY MCP KLIENTA A SERVERU

## ‚úÖ KRITICK√â OPRAVY - MCP SERVER FUNGUJE SPR√ÅVNƒö!
**Datum opravy:** 2025-09-03
**Status:** VY≈òE≈†ENO - chyba byla v m√©m k√≥du, ne v MCP serveru!

### üîß Opraven√© soubory:
1. **`/Users/m.a.j.puzik/unified-mcp-server/paperless_extension.js`** (≈ô√°dky 150-179)
   - Paperless API vrac√≠ task ID jako string, ne JSON objekt
   - P≈ôid√°no ƒçek√°n√≠ 2 sekundy a hled√°n√≠ dokumentu podle titlu
   
2. **`/Users/m.a.j.puzik/mcp_client_fixed.py`** (≈ô√°dky 80-89)
   - Opraven regex: `r'ID dokumentu:\s*(\d+|undefined|null)'`
   - Spr√°vnƒõ parsuje ƒç√≠seln√© ID z MCP odpovƒõdi

### ‚úÖ D≈Økaz funkƒçnosti:
- Nahran√© dokumenty maj√≠ ID (nap≈ô. 291, 292, 293-298+)
- Celkem nahr√°no 134+ nov√Ωch dokument≈Ø
- Datab√°ze vzrostla ze 164 na 298+ dokument≈Ø

# üÜï AKTUALIZACE 2025-09-02: MCP SERVER V4 + OCR INTEGRACE

## üéØ AKTU√ÅLN√ç PROCES: PAPERLESS B NA PORTU 8050
Tento proces pracuje s **Paperless B** instanc√≠ na portu **8050** pro testov√°n√≠ MBW dokument≈Ø.

## üåê UNIFIED MCP SERVER V4 - POVINN√â PRO V≈†ECHNA API!
**‚ö†Ô∏è KRITICK√â:** V≈°echna API vol√°n√≠ MUS√ç j√≠t p≈ôes MCP server! NIKDY nevolat API p≈ô√≠mo!

### MCP Server Konfigurace:
```bash
# Um√≠stƒõn√≠
/Users/m.a.j.puzik/unified-mcp-server/

# Spu≈°tƒõn√≠
node /Users/m.a.j.puzik/unified-mcp-server/server.js

# Port: 5002
# Verze: 4.0.1
```

### Podporovan√© API p≈ôes MCP (18 syst√©m≈Ø):
1. **PDF.co** - OCR, parsing, konverze (`pdf_convert_to_text`)
2. **AnyParser** - Strukturovan√° extrakce (`anyparser_extract_structured`)
3. **Ollama** - Lok√°ln√≠ LLM (`ollama_generate`)
4. **Paperless A** - Port 8060 (hlavn√≠ produkce)
5. **Paperless B** - Port 8050 (testovac√≠ - POU≈Ω√çV√ÅME)
6. **Loxone, Solax, OTE, Home Assistant**
7. **Gmail, Outlook, Dropbox, GitHub, N8N**

### SPR√ÅVN√â pou≈æit√≠ MCP:
```python
# ‚úÖ SPR√ÅVNƒö - p≈ôes MCP klienta
from mcp_ocr_client import MCPOCRClient
client = MCPOCRClient()
result = client.call_mcp_tool('pdf_convert_to_text', {
    'url': file_path,
    'pages': 'all'
})

# ‚ùå ≈†PATNƒö - p≈ô√≠m√© API vol√°n√≠
# requests.post('https://api.pdf.co/...') # NEPOU≈Ω√çVAT!
```

## üîç OCR PODPORA - 3 √öROVNƒö

### 1. Lok√°ln√≠ Tesseract OCR
```bash
# Instalace
brew install tesseract tesseract-lang poppler
pip install pytesseract pdf2image pillow PyPDF2

# Konfigurace
- Jazyky: ces+deu+eng
- DPI: 300 (norm√°ln√≠), 400 (vysok√° kvalita)
- Max stran: 5 (pro rychlost)
```

### 2. Cloud OCR p≈ôes MCP Server
- **PDF.co** - profesion√°ln√≠ OCR, tabulky, formul√°≈ôe
- **AnyParser** - AI extrakce, automatick√° detekce

### 3. Fallback mechanismus
```
1. pdftotext (textov√© PDF)
   ‚Üì pokud < 100 znak≈Ø
2. Tesseract OCR (lok√°ln√≠ skeny)
   ‚Üì pokud st√°le < 100 znak≈Ø
3. Cloud OCR p≈ôes MCP (slo≈æit√© dokumenty)
```

## üìÇ AKTU√ÅLN√ç SYST√âM MBW-PAPERLESS-8050

### Hlavn√≠ soubory:
```
/Users/m.a.j.puzik/MBW-Paperless-8050-backup-20250901-223950/
‚îú‚îÄ‚îÄ process_mbw_enhanced_8050.py      # Hlavn√≠ procesor s MCP integrac√≠
‚îú‚îÄ‚îÄ mcp_ocr_client.py                 # MCP klient pro v≈°echna API
‚îú‚îÄ‚îÄ mbw_config_8050.py                # Konfigurace vƒçetnƒõ OCR
‚îú‚îÄ‚îÄ enhanced_ocr_extractor.py         # P≈Øvodn√≠ cloud OCR (deprecated)
‚îú‚îÄ‚îÄ install_tesseract_ocr.sh          # Instalaƒçn√≠ skript
‚îî‚îÄ‚îÄ SYSTEM_COMPLETE_DOCUMENTATION.md  # Kompletn√≠ dokumentace
```

### Statistiky zpracov√°n√≠:
- **Celkem MBW soubor≈Ø:** 65 PDF
- **Textov√© dokumenty:** 57 (87.7%)
- **Skenovan√© dokumenty:** 8 (12.3%)
- **√öspƒõ≈°nƒõ zpracov√°no:** 57
- **Typy dokument≈Ø:** 6 (invoice, bank_statement, contract, receipt, subscription, official)

---

# üìö P≈òEHLED SKRIPT≈Æ A N√ÅSTROJ≈Æ - INVENT√Å≈ò
**Datum vytvo≈ôen√≠:** 2025-08-27
**Posledn√≠ aktualizace:** 2025-09-02  
**Autor:** Claude Code Assistant  
**Um√≠stƒõn√≠:** /Users/m.a.j.puzik

## üìä SOUHRN
Kompletn√≠ invent√°≈ô nalezen√Ωch skript≈Ø, n√°stroj≈Ø a automatizac√≠ v syst√©mu m.a.j.puzik vƒçetnƒõ z√°loh na Google Drive.

### üèÜ TOP V√ùKONNOSTN√ç N√ÅSTROJE:
- **Ultimate Document Detector** - 94% p≈ôesnost, 172,894 dokument≈Ø v datab√°zi
- **Gmail Identifier Fak Ban Stv** - Kompletn√≠ pipeline Gmail‚ÜíPaperless s identifikac√≠ dokument≈Ø, p≈ô√≠sn√Ω filtr (pouze faktury/v√Ωpisy/√∫ƒçtenky)
- **Extract Correspondent From Document** - Automatick√° identifikace korespondent≈Ø z PDF (IƒåO/DIƒå datab√°ze, confidence scoring)
  - üìÅ Z√°loha: [Google Drive/Paperless Scripts/Correspondent-Extractor-backup-20250828-184933.zip]
  - üìÑ Dokumentace: CORRESPONDENT_EXTRACTOR_DOCUMENTATION.md
- **Police Document Detector** - Specializovan√Ω detektor ƒçesk√Ωch a nƒõmeck√Ωch policejn√≠ch dokument≈Ø (5 typ≈Ø, 75-100% p≈ôesnost)
  - üìÅ Z√°loha: [Google Drive/Paperless Scripts/Police-Document-Detector-backup-20250828-200128.zip]
  - üìÑ Dokumentace: POLICE_DOCUMENT_DETECTOR_DOCUMENTATION.md
- **AI Monitor Unified** - 102KB, kompletn√≠ monitoring v≈°ech AI syst√©m≈Ø
- **Commands Logic** - 235KB, komplexn√≠ NLP pro Loxone
- **Quick Start Energy** - 74KB, kompletn√≠ energy management
- **Mass Document Processor** - 72KB, hromadn√© zpracov√°n√≠
- **AI Monitor Modular** - 67KB, modul√°rn√≠ monitoring syst√©mu

### üìà STATISTIKY SYST√âMU:
- **Celkem skript≈Ø:** 1,930+ (.sh a .py soubory)
- **Testovac√≠ch skript≈Ø:** 197+ test_*.py soubor≈Ø
- **Z√°lo≈æn√≠ch slo≈æek:** 20+ backup adres√°≈ô≈Ø
- **Google Drive z√°lohy:** 15+ kategori√≠ z√°loh

---

# üìö CLAUDE TRVAL√Å PAMƒö≈§ - PAPERLESS NGX PROJEKT

## üè∑Ô∏è KOMPLETN√ç SYST√âM TAGOV√ÅN√ç DOKUMENT≈Æ

## ‚ö†Ô∏è D≈ÆLE≈ΩIT√â: PROFORMA vs SKUTEƒåN√Å FAKTURA

**PROFORMA FAKTURA NEN√ç FAKTURA!** Je to pouze p≈ôedpis k platbƒõ.

### üö® ROZLI≈†OV√ÅN√ç:
- **PROFORMA** = p≈ôedpis k platbƒõ (NEN√ç da≈àov√Ω doklad, NELZE √∫ƒçtovat)
- **FAKTURA** = da≈àov√Ω doklad (JE √∫ƒçetn√≠ doklad, M≈Æ≈ΩE se √∫ƒçtovat)

### üîç DETEKƒåN√ç VZORY:
```python
PROFORMA_PATTERNS = [
    r'pro[\s\-]?forma\s+faktura',
    r'z√°lohov√°\s+faktura', 
    r'p≈ôedpis\s+k\s+platbƒõ',
    r'nen√≠\s+da≈àov√Ω\s+doklad',
    r'advance\s+invoice'
]

REAL_INVOICE_PATTERNS = [
    r'da≈àov√Ω\s+doklad',
    r'faktura\s*[-‚Äì]\s*da≈àov√Ω\s+doklad',
    r'tax\s+invoice'
]
```

### üè∑Ô∏è TAGOV√ÅN√ç:
- **Proforma**: `typ:proforma`, `platebn√≠-p≈ôedpis` (oran≈æov√© tagy)
- **Faktura**: `typ:faktura`, `paperless-ngx-faktury` (zelen√© tagy)

### 1Ô∏è‚É£ KATEGORIE TAG≈Æ (16 kategori√≠)
```python
CATEGORIES = {
    'banking': 'paperless-ngx-bankovnictvi',
    'invoices': 'paperless-ngx-faktury',
    'office': 'paperless-ngx-office',
    'contracts': 'paperless-ngx-smlouvy',
    'official': 'paperless-ngx-uredni-sdeleni',
    'medical': 'paperless-ngx-lekarske-zpravy',
    'subscriptions': 'paperless-ngx-predplatna',
    'bills_tv': 'paperless-ngx-platby-za-tv',
    'bills_internet': 'paperless-ngx-platby-za-internet',
    'bills_services': 'paperless-ngx-platby-za-sluzby',
    'commercial': 'paperless-ngx-obchodni-nabidky',
    'ecommerce': 'paperless-ngx-eshop',
    'social_media': 'paperless-ngx-socialni-site',
    'system_notifications': 'paperless-ngx-systemove-notifikace',
    'unclear': 'paperless-ngx-nejasne',
    'spam': 'paperless-ngx-spam'
}
```

### 2Ô∏è‚É£ CORRESPONDENT TAGY (User/Email odes√≠latele)
**D≈ÆLE≈ΩIT√â:** Vytv√°≈ô√≠ se automaticky z emailov√© adresy odes√≠latele nebo obsahu!

```python
# Z emailu: sender@csob.cz ‚Üí Tag: "ƒåSOB"
# Z obsahu: "Finanƒçn√≠ √∫≈ôad Praha" ‚Üí Tag: "Finanƒçn√≠ √∫≈ôad Praha"

DOMAIN_TO_CORRESPONDENT = {
    'csob.cz': 'ƒåSOB',
    'kb.cz': 'Komerƒçn√≠ banka',
    'csas.cz': 'ƒåesk√° spo≈ôitelna',
    'rb.cz': 'Raiffeisenbank',
    'moneta.cz': 'Moneta',
    'alza.cz': 'Alza',
    'amazon.com': 'Amazon',
    'facebook.com': 'Facebook',
    # ... dal≈°√≠ch 80+ mapov√°n√≠
}
```

### 3Ô∏è‚É£ METADATA TAGY
- **Rok:** `2025`, `2024`, `2023`
- **Mƒõs√≠c:** `leden`, `√∫nor`, ... `prosinec`
- **Velikost faktury:** `velk√°-faktura` (>10000 Kƒç), `mal√°-faktura`
- **DPH:** `s-dph`, `bez-dph`, `dph-21`, `dph-15`, `dph-10`
- **IƒåO:** `ico-12345678` (z obsahu dokumentu)
- **DIƒå:** `dic-CZ12345678` (z obsahu dokumentu)
- **VS:** `vs-123456789` (variabiln√≠ symbol)
- **Konfidence:** `konfidence-95`, `konfidence-80` atd.
- **Zdroj:** `import-gmail`, `import-manual`, `import-scanner`

### 4Ô∏è‚É£ BANKOVN√ç TAGY
- **ƒåesk√© banky:** `ƒåSOB`, `KB`, `ƒåesk√°-spo≈ôitelna`, `Raiffeisenbank`, `Moneta`, `Fio`, `AirBank`
- **Zahraniƒçn√≠:** `N26`, `Revolut`, `Deutsche-Bank`, `Erste-Bank`, `BAWAG`
- **Typ v√Ωpisu:** `mƒõs√≠ƒçn√≠-v√Ωpis`, `roƒçn√≠-v√Ωpis`, `v√Ωpis-z-karty`

### 5Ô∏è‚É£ POVINN√â N√ÅLE≈ΩITOSTI ƒåESK√â FAKTURY
```python
CZECH_INVOICE_REQUIREMENTS = {
    1: "Oznaƒçen√≠ 'Faktura' nebo 'Da≈àov√Ω doklad'",
    2: "IƒåO dodavatele (8 ƒç√≠slic)",
    3: "DIƒå dodavatele (CZ + 8-10 ƒç√≠slic)",
    4: "Datum vystaven√≠",
    5: "Datum uskuteƒçnƒõn√≠ zdaniteln√©ho plnƒõn√≠ (DUZP)",
    6: "Evidenƒçn√≠ ƒç√≠slo faktury",
    7: "N√°zev a s√≠dlo dodavatele",
    8: "N√°zev a s√≠dlo odbƒõratele",
    9: "Rozsah a p≈ôedmƒõt plnƒõn√≠",
    10: "Z√°klad danƒõ podle sazeb (21%, 15%, 10%, 0%)",
    11: "V√Ω≈°e DPH",
    12: "Celkov√° ƒç√°stka k √∫hradƒõ"
}

# Regex vzory pro detekci:
ICO_PATTERN = r'IƒåO?:?\s*(\d{8})'
DIC_PATTERN = r'DIƒå:?\s*(CZ\d{8,10})'
VS_PATTERN = r'VS:?\s*(\d+)'
AMOUNT_PATTERN = r'celkem:?\s*([\d\s]+[,.]?\d*)\s*(?:Kƒç|CZK)'
```

## üö® KRITICK√â PRAVIDLO UPLOADU - ABSOLUTN√ç Z√ÅKAZ CONSUMER!

### ‚ö†Ô∏è POVINN√â: JEN A POUZE MCP SERVER API!
```python
# ‚úÖ JEDIN√ù POVOLEN√ù ZP≈ÆSOB - MCP SERVER API
from mcp_ocr_client import MCPOCRClient
client = MCPOCRClient()
result = client.call_mcp_tool('paperless_upload_document', {
    'file_path': '/path/to/document.pdf',
    'tags': ['faktury', 'ƒåSOB', '2025'],
    'correspondent': 'ƒåSOB',
    'title': 'Faktura ƒåSOB'
})

# ‚ùå ABSOLUTNƒö ZAK√ÅZ√ÅNO - V≈†E OSTATN√ç!
# docker cp ‚Üí ZAK√ÅZ√ÅNO
# curl API ‚Üí ZAK√ÅZ√ÅNO  
# consume folder ‚Üí ZAK√ÅZ√ÅNO
# p≈ô√≠m√© API ‚Üí ZAK√ÅZ√ÅNO
```

**D≈ÆVOD:** Pouze MCP server zaruƒçuje spr√°vn√© tagy a metadata!

## üîÑ WORKFLOW ZPRACOV√ÅN√ç

### KROK 1: P≈ôevod do PDF
```python
# Email s p≈ô√≠lohami ‚Üí Slouƒçen√Ω PDF
# 1. strana: Email hlaviƒçka
# 2. strana: Email tƒõlo
# 3+ strany: V≈°echny p≈ô√≠lohy
```

### KROK 2: Detekce typu (v po≈ôad√≠ priority)
1. **PROFORMA CHECK** - explicitn√≠ kontrola na "proforma" (NEJVY≈†≈†√ç PRIORITA)
2. **Filename analysis** - rychl√©, podle n√°zvu (+30 bod≈Ø)
3. **Text extraction** - pdftotext, max 5 stran
4. **Czech invoice requirements** - ¬ß 28 ZDPH n√°le≈æitosti (7 krit√©ri√≠)
5. **Pattern matching** - regex, keywords (+15 bod≈Ø/match)
6. **OCR** - jen kdy≈æ < 500 znak≈Ø textu
7. **ML classification** - BART model, kdy≈æ confidence < 70%

### ‚ö†Ô∏è PROFORMA KONTROLA:
```python
# NEJVY≈†≈†√ç PRIORITA - kontrola na proforma
if 'proforma' in filename.lower():
    return 'proforma'  # NEN√ç faktura!

if re.search(r'p≈ôedpis\s+k\s+platbƒõ|advance\s+invoice', text):
    return 'proforma'  # NEN√ç faktura!
```

### KROK 3: Bodov√°n√≠
- N√°zev souboru match: **+30 bod≈Ø**
- Kl√≠ƒçov√© slovo: **+15 bod≈Ø**
- Regex match (IƒåO, DIƒå): **+25 bod≈Ø**
- Instituce nalezena: **+35 bod≈Ø**
- OCR match: **+20 bod≈Ø**
- ML confidence: **+50 √ó confidence**
- **Minimum pro rozpozn√°n√≠: 50 bod≈Ø**

### KROK 4: P≈ôi≈ôazen√≠ tag≈Ø
1. Kategorie tag
2. Correspondent tag (z emailu nebo obsahu)
3. Rok a mƒõs√≠c
4. Specifick√© tagy (IƒåO, DIƒå, VS)
5. Metadata tagy (konfidence, zdroj)

## üìÅ D≈ÆLE≈ΩIT√â SOUBORY

### Detektory:
- `/Users/m.a.j.puzik/ultimate_document_detector.py` - Hlavn√≠ detektor (11 kategori√≠, 94% p≈ôesnost)
- `/Users/m.a.j.puzik/police_document_detector.py` - Policejn√≠ dokumenty (5 typ≈Ø, 75-100% p≈ôesnost)
- `/Users/m.a.j.puzik/czech_german_bank_statement_detector.py` - Bankovn√≠ v√Ωpisy
- `/Users/m.a.j.puzik/german_invoice_detector.py` - Nƒõmeck√© faktury
- `/Users/m.a.j.puzik/austrian_invoice_detector.py` - Rakousk√© faktury
- `/Users/m.a.j.puzik/chinese_invoice_detector.py` - ƒå√≠nsk√© faktury

### Processory:
- `/Users/m.a.j.puzik/gmail_paperless_with_attachments.py` - Gmail s p≈ô√≠lohami
- `/Users/m.a.j.puzik/universal_pdf_tagger.py` - Universal tagger
- `/Users/m.a.j.puzik/extract_correspondents.py` - Extrakce korespondent≈Ø

### Konfigurace:
- `/Users/m.a.j.puzik/bank_configs/` - Konfigurace bank

## üîë API KONFIGURACE - T≈òI PAPERLESS SERVERY

### PAPERLESS A [PORT 8060] - Hlavn√≠ produkce
```python
PAPERLESS_A_URL = "http://localhost:8060"
PAPERLESS_A_TOKEN = "797eb57399bdb346dcc802e7666ddc316b6e8052"  # ‚ö†Ô∏è AKTUALIZOV√ÅNO 2025-09-03
LOGIN_A = "admin"
PASSWORD_A = "admin123"
```

### PAPERLESS B [PORT 8050] - Testovac√≠ (MBW dokumenty)
```python
PAPERLESS_B_URL = "http://localhost:8050"
PAPERLESS_B_TOKEN = "85919386a7e8c42f0dc8608535816bb109b73305"  # ‚ö†Ô∏è AKTUALIZOV√ÅNO 2025-09-03
LOGIN_B = "admin"
PASSWORD_B = "admin"
```

### PAPERLESS C [PORT 8075] - HTML GUI testy s Ultimate Detector V10
```python
PAPERLESS_C_URL = "http://localhost:8075"  # ‚ö†Ô∏è NOV√Å INSTANCE!
PAPERLESS_C_TOKEN = "dbfcde56d1b185aa5507b86ca8f381e5fdf44fd6"  # ‚ö†Ô∏è OPRAVENO 2025-09-05 (admin token)
LOGIN_C = "admin"
PASSWORD_C = "admin"

# ‚ö†Ô∏è POU≈ΩIT√ç: HTML aplikace + Ultimate Document Detector V10 (94% p≈ôesnost)
# Pro MCP Server V4 upload:
headers_C = {
    "Authorization": f"Token {PAPERLESS_C_TOKEN}",
    "Content-Type": "application/json"
}
```

## ‚ö° RYCHL√â P≈ò√çKAZY

```bash
# Spustit MBW procesor pro Paperless B (port 8050)
cd /Users/m.a.j.puzik/MBW-Paperless-8050-backup-20250901-223950
python3 process_mbw_enhanced_8050.py

# Test MCP OCR klienta
python3 mcp_ocr_client.py /cesta/k/dokumentu.pdf

# Upload do Paperless B [PORT 8050] - MBW dokumenty
curl -X POST http://localhost:8050/api/documents/post_document/ \
  -H "Authorization: Token 85919386a7e8c42f0dc8608535816bb109b73305" \
  -F "document=@dokument.pdf" \
  -F "tags=1,2,3"

# Upload do Paperless A [PORT 8060] - hlavn√≠ produkce
curl -X POST http://localhost:8060/api/documents/post_document/ \
  -H "Authorization: Token 797eb57399bdb346dcc802e7666ddc316b6e8052" \
  -F "document=@dokument.pdf" \
  -F "tags=1,2,3"

# Upload do Paperless C [PORT 8075] - HTML GUI testy (P≈òES MCP SERVER!)
curl -X POST http://localhost:5002/paperless-intelligence/upload \
  -H "Content-Type: application/json" \
  -d '{"file_content":"base64_content","filename":"dokument.pdf","port":8075}'
```

## üéØ C√çLE PROJEKTU
1. ‚úÖ 92%+ p≈ôesnost klasifikace (dosa≈æeno: 94%)
2. ‚úÖ Automatick√© tagov√°n√≠ v≈°ech dokument≈Ø
3. ‚úÖ Correspondent tagy z email≈Ø
4. ‚úÖ Zpracov√°n√≠ p≈ô√≠loh email≈Ø
5. ‚è≥ Upload 170,000+ dokument≈Ø do Paperless

## üìö DOKUMENTACE SYST√âMU

### üÜï Paperless Upload System v0.1 (2025-09-03)
**üìñ Kompletn√≠ dokumentace:** [`PAPERLESS_UPLOAD_DOKUMENTACE_v0.1.md`](/Users/m.a.j.puzik/PAPERLESS_UPLOAD_DOKUMENTACE_v0.1.md)

#### Hlavn√≠ features v0.1:
- ‚úÖ **320 dokument≈Ø** √∫spƒõ≈°nƒõ nahr√°no na port 8050
- ‚úÖ **MBW faktury** - automatick√© zpracov√°n√≠ s odstranƒõn√≠m diakritiky
- ‚úÖ **ƒåSOB bankovn√≠ v√Ωpisy** - konverze XML ‚Üí PDF pomoc√≠ reportlab
- ‚úÖ **OneDrive integrace** - 164,462 PDF nalezeno, batch upload implementov√°n
- ‚úÖ **Automatick√° detekce** - typy dokument≈Ø, correspondenti, tagy

#### Hlavn√≠ skripty:
- `upload_mbw_no_diacritics.py` - Upload MBW s ƒçi≈°tƒõn√≠m diakritiky
- `fix_csob_proper.py` - Konverze ƒåSOB XML na PDF
- `upload_all_onedrive.py` - Masivn√≠ upload z OneDrive
- `upload_scanned_docs.py` - Upload naskenovan√Ωch dokument≈Ø

---
*Posledn√≠ aktualizace: 3.9.2025*
*Autor: M.A.J. Pu≈æ√≠k + Claude Code Assistant*
*Proces: Paperless B (port 8050) s MCP Server V4 integrac√≠*
*Verze dokumentace: 0.1*
## ‚ö†Ô∏è D≈ÆLE≈ΩIT√â UPOZORNƒöN√ç - OPRAVEN√â SKRIPTY (2025-09-05)

### ‚úÖ SPR√ÅVN√â SOUBORY K POU≈ΩIT√ç:
- `/Users/m.a.j.puzik/paperless_importer_complete_FIXED.py` - POU≈ΩIJ TENTO\! M√° opraven√©:
  - NULL check pro correspondent_info (≈ô√°dek 205: correspondent_info = {})
  - Spr√°vn√© vol√°n√≠ extract_from_document() m√≠sto jin√Ωch metod
  - Fallback mechanismy pro korespondenty

### ‚ùå NEPOU≈Ω√çVAT (maj√≠ chyby):
- Jak√©koliv importery v /tmp/ - jsou doƒçasn√© a miz√≠
- Star√© verze bez _FIXED suffixu

### üìù P≈òIPOM√çNKA:
P≈ôi ka≈æd√©m startu NEJD≈ò√çV zkontroluj, zda pou≈æ√≠v√°≈° _FIXED verze skript≈Ø\!

EOF < /dev/null
## üìÖ POSLEDN√ç ZMƒöNY: 2025-09-05
- Opraveny NULL pointer chyby v correspondent_extractor
- Vytvo≈ôen MAIN_PAPERLESS_IMPORTER.py jako definitivn√≠ verze
- Dokumentace v DAILY_CHANGES_2025-09-05.md
- Backup v /Users/m.a.j.puzik/paperless-backup-2025-09-05/
